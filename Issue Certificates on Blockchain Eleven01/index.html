<!doctype html>
<html class="requstor-bgcolor" lang="en">

<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />

	<meta name="keywords" content="....">
	<meta name="description" content="....">
	<link rel="shortcut icon" type="image/png" href="images/tech1.png" />
	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="css/custom.css" />
	<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	  -->
	<script src="./private-key-modal/private-key-modal.js" type="text/javascript"></script>
	<script src="./helpers/index.js" type="text/javascript"></script>
	<script src="http://code.jquery.com/jquery-1.4.min.js" type="text/javascript"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.36/dist/web3.min.js"
		integrity="sha256-nWBTbvxhJgjslRyuAKJHK+XcZPlCnmIAAMixz6EefVk=" crossorigin="anonymous"></script>
	<script>
		$(document).ready(function () {

			$("certificates").fadeIn(0);

			$("register").fadeOut(0);

			$("viewall").fadeOut(0);

			$(".btn1").click(function () {
				var text1 = document.getElementById('certificates');
				console.log(text1.classList);
				text1.classList.add('active');
				text1.classList.remove('our-buttons1');
				var text2 = document.getElementById('register');
				text2.classList.add('our-buttons1');
				var text3 = document.getElementById('viewall');
				text3.classList.add('our-buttons1');

				$("certificates").fadeIn(0);

				$("register").fadeOut(0);

				$("viewall").fadeOut(0);

			});

			$(".btn2").click(function () {
				var text1 = document.getElementById('certificates');
				text1.classList.add('our-buttons1');
				var text2 = document.getElementById('register');
				text2.classList.add('active');
				text2.classList.remove('our-buttons1');
				console.log(text2.classList);
				var text3 = document.getElementById('viewall');
				text3.classList.add('our-buttons1');

				$("certificates").fadeOut(0);

				$("register").fadeIn(0);

				$("viewall").fadeOut(0);

			});

			$(".btn3").click(function () {
				var text1 = document.getElementById('certificates');
				text1.classList.add('our-buttons1');
				var text2 = document.getElementById('register');
				text2.classList.add('our-buttons1');
				var text3 = document.getElementById('viewall');
				text3.classList.add('active');
				text3.classList.remove('our-buttons1');


				$("certificates").fadeOut(0);

				$("register").fadeOut(0);

				$("viewall").fadeIn(0);

			});
		});


	</script>

	<title>TechMahindra</title>
</head>

<body class="main-bgcolor">
	<div class="container-fluid">
		<div class="row">

			<div class="col-xl-2 col-lg-2 col-md-4 col-sm-6 col-xs-6 col-12 sidebar"
				style="background-color: #e51837;color:white;">
				Welcome User
			</div>


			<div class="col-xl-10 col-lg-10 col-md-8 col-sm-6 col-xs-6 col-12" style="background-color: white">
				<div class="content-bgcolor">
					<div class="row">
						<div class="col-lg-7 col-md-5 col-sm-12 col-xs-12">

							<h6 class="certificatestudiotitle">Tech Mahindra Blockchain Certificate Studio</h6>

						</div>
						<div class="col-lg-2 col-md-5 col-sm-12 col-xs-12" style="margin-top:20px">

						</div>
						<div class="col-lg-3 col-md-2 col-sm-12 col-xs-12">
							<img src="./images/tech1.png" style="height:79px" />
						</div>
					</div>
					<div class="row">
						<div class=" col-lg-5 col-md-5 col-sm-12 col-xs-12"></div>
						<div class="col-lg-7 col-md-7 col-sm-12 col-xs-12 ">
							<a href="approver-login.html" id="approver"
								class="btn1 our-buttons1  btn buttons-common-3">approver</a>
							<a id="certificates" class="btn1 active btn buttons-common-3">My Certificates</a>
							<a id="register" class="btn2 btn our-buttons1 buttons-common-3">Register</a>
							<a id="viewall" class="btn3 btn our-buttons1 buttons-common-3">View All</a>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<certificates>
								<div class="row content">
									<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 col">

									</div>
									<div class="col-lg-8 col-md-8 col-sm-12 col-xs-12 col approver-header">
										<h4>Certificate Details</h4>
									</div>

								</div>
								<div class="row content">
									<div class="col-lg-12 col-md-12 col-xs-12 col-sm-12" col>
										<table class="table">
											<tr>
												<th>Id</th>
												<th>CourseName</th>
												<th>StartDate</th>
												<th>EndDate</th>
												<th>LearningHours</th>


											</tr>
										</table>
									</div>
								</div>
							</certificates>
							<register>
								<dialog id="favDialog">
									<form method="dialog">
										<p><label>PrivateKey:
												<input type="text" id="privatekey" />
											</label></p>
										<menu>
											<button value="cancel">Cancel</button>
											<button id="confirmBtn" onclick="onSubmitPrivateKey()"
												value="default">Confirm</button>
										</menu>
									</form>
								</dialog>
								<section class="mywallet main-content">
									<div class="container">
										<div class="wrapper">
											<div class="row content p-0">
												<div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 col">

												</div>
												<div class="col-lg-8 col-md-8 col-sm-12 col-xs-12 col  approver-header">
													<h4>Details of the certificate</h4>
												</div>
											</div>
											<div class="row content">
												<div class="col-lg-2 col-md-2 col-sm-1 col-xs-1"></div>
												<div class="col-lg-4 col-md-4 col-sm-5 col-xs-5">

													<div class="mb-3">
														<label for="employeeid">Employee Id</label>
														<input type="text" class="form-control our-inputs"
															id="employeeid" placeholder=" employeeId" required="">
													</div>

													<div class="mb-3">
														<label for="grade">Candidate Name</label>
														<input type="text" class="form-control our-inputs"
															id="candidatename" placeholder="CandidateName" required="">
													</div>
													<div class="mb-3">
														<label for="coursename">Course Name</label>
														<select name="coursename" class="form-control our-inputs"
															id="coursename" required="">
															<option style="display:none" value="">select</option>
															<option value="ethereum">Ethereum</option>
															<option value="hyperledger">Hyperledger</option>
															<option value="corda">Corda</option>
															<option value="quorum">Quorum</option>
															<option value="solidity">Solidity Developer</option>
															<option value="iota">IOTA</option>
															<option value="multichain">Multichain</option>
															<option value="bigchaindb">BigchainDB</option>
															<option value="go">Go Developer</option>
														</select>
													</div>
												</div>
												<div class="col-lg-4 col-md-4 col-sm-5 col-xs-5">


													<div class="mb-3">
														<label for="startdate">Start Date</label>
														<input type="date" class="form-control our-inputs"
															id="startdate" placeholder="StartDate" required="">
													</div>
													<div class="mb-3">
														<label for="enddate">End Date</label>
														<input type="date" class="form-control our-inputs" id="enddate"
															placeholder="EndDate" required="">
													</div>
													<div class="mb-3">
														<label for="hours">Learning Hours</label>
														<input type="text" class="form-control our-inputs" id="hours"
															placeholder="Hours" required="">
													</div>
													<div class="mb-3" style="display:none">
														<label for="privatekey">Private Key</label>
														<input type="text" class="form-control our-inputs"
															id="privatekey"
															value="C9A9FC8220C269298D033087B2EFEBBDFCFA6E64A416ABC73B2E1A600C1A5578"
															placeholder="privatekey" required="">
													</div>
												</div>
												<div class="col-lg-2 col-md-2 col-sm-1 col-xs-1"></div>

											</div>

											<div class="row">
												<div class="col-md-5"></div>
												<div class="col-md-7">
													<button id="regbutton"
														class="btn  text-center content our-buttons buttons-common-1">Register</button>
												</div>
											</div>

										</div>
									</div>

								</section>



								<footer align="center" class="mt-5">
									<p>To Check The Details Go to page: <a
											href="verify.html"><strong>Verify</strong></a></p>
								</footer>

								<style type="text/css">
									h1,
									h2,
									h3,
									h4,
									h5,
									h6 {
										color: #394240
									}

									.certificate-4 {
										font-family: 'Merriweather', serif;
										/* font-family: 'Merriweather', serif;
                           font-family: 'Roboto Slab', serif; */
										background: #fff;
										padding: 40px 20px;
										border: #394240 solid 6px;
										/* background: url(images/certificate/certificate-3-bg.png);
                               */
										background-position: center center;
										background-size: auto;
										background-repeat: no-repeat;
										text-align: center;
									}

									.certificate-4 h1 {
										font-size: 45px;
										font-weight: 700
									}

									.certificate-4 h3 {
										font-size: 30px;
										font-weight: 700
									}

									.certificate-4 .small-texts {
										font-size: 13px;
										font-style: italic
									}

									.certificate-4 .certificate-footer p {
										margin-bottom: 5px;
										font-size: 12px;
										text-align: center;
										line-height: 14px
									}

									.certificate-4 .certificate-footer p.subtitle {
										font-weight: 700;
										font-size: 14px;
										color: #555
									}

									.certificate-4 .certificate-footer div {
										text-align: center;
										color: #8e8a8a;
										border-top: solid 2px #8e8a8a;
										margin-top: 20px;
										padding-top: 10px;
										line-height: 16px;
										margin-bottom: 20px;
									}

									.certificate-4 .certificate-body {
										margin-bottom: 15px;
										padding: 20px 0px
									}

									.certificate-4 .certificate-footer {
										margin: 15px;
										font-size: 13px
									}

									.certificate-4 h6 {
										font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue',
											sans-serif;
										color: #555;
										font-size: 11px;
									}

									.certificate-4 .trash-hash-title {
										font-size: 11px;
									}

									.certificate-4 .trash-hash-text {
										font-size: 10px;
										word-break: break-all;
										line-height: 18px !important;
										display: inline-block;
									}

									.certificate-4 .issuedby {
										font-size: 9px;
										word-break: break-all;
									}
								</style>




								<!-- Optional JavaScript -->
								<!-- jQuery first, then Popper.js, then Bootstrap JS -->
								<!-- <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
                               <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
                               <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script> -->
								<script>

									// if (typeof web3 !== "undefined") {
									//     web3 = new Web3(web3.currentProvider);
									// } else {
									//     web3 = new Web3(new Web3.providers.HttpProvider("http://13.83.91.1:8083/api/node/rpc"));
									//   }

									//Replace with your ABI

									var abi = [
										{
											"constant": false,
											"inputs": [
												{
													"name": "EmpId",
													"type": "string"
												},
												{
													"name": "CandidateName",
													"type": "string"
												},
												{
													"name": "CourseName",
													"type": "string"
												},
												{
													"name": "DateOfStart",
													"type": "string"
												},
												{
													"name": "DateOfCompletion",
													"type": "string"
												},
												{
													"name": "NumHours",
													"type": "uint256"
												}
											],
											"name": "certificateIssue",
											"outputs": [],
											"payable": false,
											"stateMutability": "nonpayable",
											"type": "function"
										},
										{
											"inputs": [],
											"payable": false,
											"stateMutability": "nonpayable",
											"type": "constructor"
										},
										{
											"anonymous": false,
											"inputs": [
												{
													"indexed": false,
													"name": "EmpId",
													"type": "string"
												},
												{
													"indexed": false,
													"name": "CandidateName",
													"type": "string"
												},
												{
													"indexed": false,
													"name": "CourseName",
													"type": "string"
												},
												{
													"indexed": false,
													"name": "DateOfStart",
													"type": "string"
												},
												{
													"indexed": false,
													"name": "DateOfCompletion",
													"type": "string"
												},
												{
													"indexed": false,
													"name": "NumHours",
													"type": "uint256"
												}
											],
											"name": "CertificateEvent",
											"type": "event"
										},
										{
											"constant": true,
											"inputs": [],
											"name": "admin",
											"outputs": [
												{
													"name": "",
													"type": "address"
												}
											],
											"payable": false,
											"stateMutability": "view",
											"type": "function"
										},
										{
											"constant": true,
											"inputs": [
												{
													"name": "",
													"type": "uint256"
												}
											],
											"name": "certificateData",
											"outputs": [
												{
													"name": "Id",
													"type": "uint256"
												},
												{
													"name": "Issuer",
													"type": "address"
												},
												{
													"name": "EmpId",
													"type": "string"
												},
												{
													"name": "CandidateName",
													"type": "string"
												},
												{
													"name": "CourseName",
													"type": "string"
												},
												{
													"name": "DateOfStart",
													"type": "string"
												},
												{
													"name": "DateOfCompletion",
													"type": "string"
												},
												{
													"name": "NumHours",
													"type": "uint256"
												}
											],
											"payable": false,
											"stateMutability": "view",
											"type": "function"
										},
										{
											"constant": true,
											"inputs": [],
											"name": "certificateDataCount",
											"outputs": [
												{
													"name": "",
													"type": "uint256"
												}
											],
											"payable": false,
											"stateMutability": "view",
											"type": "function"
										}
									];
									//Replace with your contract address

									var contractAddress =
										"0x029e8541d3c28f0406853289cb40968e099500e4";
									var version = web3.version;
									console.log("web3 version is: ", version);
					
									const Certificate = web3.eth.contract(abi).at("0x029e8541d3c28f0406853289cb40968e099500e4");
									console.log("abi functions are: ",Certificate.abi);
									console.log("contractAddress is:",contractAddress)

								
									
									
									/*	async function init() {
											window.addEventListener('load', async () => {
												if (window.ethereum) {
													window.web3 = new Web3(window.ethereum);
													await window.ethereum.enable();
													var web3 = new Web3(Web3.givenProvider)
													var accounts = await web3.eth.getAccounts();
	
													account = accounts[0];
													Certificate = await new web3.eth.Contract(abi, contractAddress);
													console.log(Certificate)
													console.log(accounts)
												}
												else {
													console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');
												}
											})
	
										}
										init();*/

									async function register() {


										var EmployeeId = document.getElementById('employeeid').value;
										var CandidateName = document.getElementById('candidatename').value;
										var CourseName = document.getElementById('coursename').value;
										var StartDate = document.getElementById('startdate').value;
										var EndDate = document.getElementById('enddate').value;
										var Hours = document.getElementById('hours').value;



										const tx = {
											from: "C9A9FC8220C269298D033087B2EFEBBDFCFA6E64A416ABC73B2E1A600C1A5578",
											to: "0x029e8541d3c28f0406853289cb40968e099500e4",
											gas: "50000000",
											value: '0x00',
											data1: Certificate.certificateIssue(EmployeeId, CandidateName, CourseName, StartDate, EndDate, Hours).send({ from: account }).on('receipt', function (receipt) {
											//data1: Certificate.methods.certificateIssue(EmployeeId, CandidateName, CourseName, StartDate, EndDate, Hours).send({ from: account }).on('receipt', function (receipt) {


												console.log(receipt);
												document.getElementById('employeeid').textContent = receipt.events.CertificateEvent.returnValues.EmployeeId;
												console.log('EmployeeId', EmployeeId);
												document.getElementById('CandidateName').textContent = receipt.events.CertificateEvent.returnValues.CandidateName;
												console.log('CandidateName', CandidateName);
												document.getElementById('CourseName').textContent = receipt.events.CertificateEvent.returnValues.CourseName;
												console.log('CourseName', CourseName);
												document.getElementById('StartDate').textContent = receipt.events.CertificateEvent.returnValues.StartDate;
												console.log('StartDate', StartDate);
												document.getElementById('EndDate').textContent = receipt.events.CertificateEvent.returnValues.EndDate;
												console.log('EndDate', EndDate);
												document.getElementById('hours').textContent = receipt.events.CertificateEvent.returnValues.Hours;
												console.log('Hours', Hours);

												document.getElementById("Registerhash").innerHTML = receipt.transactionHash;
												console.log('Registerhash', Registerhash);


											})

										}

										var privateKey = "C9A9FC8220C269298D033087B2EFEBBDFCFA6E64A416ABC73B2E1A600C1A5578";
										const signPromise = web3.eth.accounts.signTransaction(tx, privateKey);
										console.log("tx is; ", tx);
										console.log("privateKey", privateKey);
										console.log("signPromise", signPromise);

										signPromise.then((signedTx) => {
											// raw transaction string may be available in .raw or 
											// .rawTransaction depending on which signTransaction
											// function was called
											console.log("signedTx", signedTx);
											console.log("rawTransaction is: ", signedTx.rawTransaction);

											/*	const sentTx = web3.eth.sendSignedTransaction(signedTx.raw || signedTx.rawTransaction);
												console.log("*********************************************");
												
												*/


											web3.eth.sendSignedTransaction(signedTx.rawTransaction, function (err, hash) {
												if (!err) {
													console.log('Txn Sent and hash is ' + hash);
												}
												else {
													console.error(err);
												}
											});


											/*	sentTx.on("receipt", receipt  =>  {
													// do something when receipt comes back
					
													if (!err) {
														console.log('Txn Sent and hash is ' + hash);
													}
													else {
														console.error(err);
													}
	
												});
												sentTx.on("error", err => {
													// do something on transaction error
													console.log("Signed Transaction failed");
	
	
												});*/
										}).catch((err) => {
											// do something when promise fails
											console.log("Transaction failed");
										});

									}
									document.getElementById('regbutton').addEventListener('click', register);
								</script>
							</register>
							<viewall>

								<div class="s003">
									<div class="row">
										<div class="col-md-3"></div>
										<div class="col-md-9">
											<form>
												<div class="inner-form">
													<div class="input-field first-wrap">
														<div class="input">
															<select style="border-right: 1px solid grey" data-trigger=""
																id="coursename" name="choices-single-defaul">
																<option placeholder="" style="display: none">Course Name
																</option>
																<option>Ethereum</option>
																<option>Hyperledger</option>
																<option>Corda</option>
																<option>Quorum</option>
																<option>Solidity Developer</option>
																<option>IOTA</option>
																<option>MultiChain</option>
																<option>BigChainDB</option>
																<option>GoDeveloper</option>
															</select>
															<select style="border-right: 1px solid grey" data-trigger=""
																id="year" name="choices-single-defaul">
																<option placeholder="" style="display: none">Year Of
																	Completion</option>
																<option>2019</option>
																<option>2018</option>
																<option>2017</option>
																<option>2016</option>
																<option>2015</option>
																<option>2014</option>
																<option>2013</option>
																<option>2012</option>
																<option>2011</option>
																<option>2010</option>
															</select>
															<input id="search" type="text" placeholder="LearningHours"
																id="learninghours" />
															<button class="btn-search input-field third-wrap"
																type="button" id="search1">
																<svg class="svg-inline--fa fa-search fa-w-16"
																	aria-hidden="true" data-prefix="fas"
																	data-icon="search" role="img"
																	xmlns="http://www.w3.org/2000/svg"
																	viewBox="0 0 512 512">
																	<path fill="currentColor"
																		d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
																	</path>
																</svg>
															</button>
														</div>
													</div>

												</div>
											</form>
										</div>
									</div>
									<div class="row">
										<div class="col-md-3"></div>
										<div class="col-md-9">
											<form>
												<div class="inner-form">
													<div class="input-field first-wrap">
														<div class="input">
															<input id="certificateid" type="text"
																placeholder="CertificateID" />
															<button class="btn-search input-field third-wrap"
																type="button" id="search2">
																<svg class="svg-inline--fa fa-search fa-w-16"
																	aria-hidden="true" data-prefix="fas"
																	data-icon="search" role="img"
																	xmlns="http://www.w3.org/2000/svg"
																	viewBox="0 0 512 512">
																	<path fill="currentColor"
																		d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z">
																	</path>
																</svg>
															</button>
														</div>
													</div>

												</div>
											</form>
										</div>
									</div>

								</div>

							</viewall>
						</div>
					</div>
				</div>
			</div>
		</div>


	</div>


</body>

</html>